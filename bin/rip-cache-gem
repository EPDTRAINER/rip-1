#!/usr/bin/env ruby
# Usage: rip-cache-gem NAME VERSION

require 'rip/script'

target  = ARGV[0]
version = ARGV[1]

cache = Rip::GemPackage.new(target, nil, version).cache_path

synchronize(cache) do
  if File.directory?(cache)
    puts cache
  else
    mkdir_p Rip.cache
    cd Rip.cache
    gem version ? "fetch #{target} -v #{version}" : "fetch #{target}"
    if File.exist?(cache)
      puts cache
    else
      exit 1
    end
  end
end
