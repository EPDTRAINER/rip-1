#!/usr/bin/env ruby
# Usage: rip-fetch-dependencies deps.rip
# Recursively downloads dependencies.

require 'rip/script'

def fetch_dependencies(env)
  env.packages.each do |package|
    path = rip("package #{package.source} #{package.version}")

    if File.exists? deps = "#{path}/deps.rip"
      warn "found #{deps}"
      fetch_dependencies Environment.new(deps)
    end

    puts path
  end
end

fetch_dependencies Environment.new(ARGV * ' ')
