#!/usr/bin/env ruby
# Usage: rip-package URL

require 'rip/script'

debug "packaging #{ARGV * ' '}"

rip(:commands).grep(/^package-/).each do |handler|
  out = rip(handler.chomp, ARGV)

  if $?.exitstatus == 3
    next
  elsif $?.success?
    out.split("\n").each do |package_path|
      puts rip(:build, package_path)
    end
    exit 0
  else
    exit $?.exitstatus
  end
end
